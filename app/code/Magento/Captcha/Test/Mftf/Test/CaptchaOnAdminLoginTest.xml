<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="CaptchaOnAdminLoginTest">
        <annotations>
            <features value="Captcha"/>
            <stories value="Test creation for send comment using the contact us form with captcha."/>
            <title value="Captcha contact us form test"/>
            <description value="Test creation for send comment using the contact us form with captcha."/>
            <severity value="MAJOR"/>
            <group value="captcha"/>
            <group value="mtf_migrated"/>
        </annotations>
        <before>

        </before>
        <after>

        </after>
        <!-- Open admin login page -->
        <amOnPage url="{{AdminLoginPage.url}}" stepKey="goToAdminLoginPage" />
        <waitForPageLoad stepKey="waitForPageLoad1" />

        <!-- Login as Admin with incorrect credentials 3 times -->
        <fillField selector="{{AdminLoginFormSection.username}}" userInput="adminUser" stepKey="fillUsername1"/>
        <fillField selector="{{AdminLoginFormSection.password}}" userInput="adminPassword" stepKey="fillPassword1"/>
        <click selector="{{AdminLoginFormSection.signIn}}" stepKey="clickLogin1"/>
        <see userInput="The account sign-in was incorrect or your account is disabled temporarily. Please wait and try again later." selector="{{AdminLoginFormSection.error}}" stepKey="seeLoginError1"/>

        <fillField selector="{{AdminLoginFormSection.username}}" userInput="adminUser" stepKey="fillUsername2"/>
        <fillField selector="{{AdminLoginFormSection.password}}" userInput="adminPassword" stepKey="fillPassword2"/>
        <click selector="{{AdminLoginFormSection.signIn}}" stepKey="clickLogin2"/>
        <see userInput="The account sign-in was incorrect or your account is disabled temporarily. Please wait and try again later." selector="{{AdminLoginFormSection.error}}" stepKey="seeLoginError2"/>

        <fillField selector="{{AdminLoginFormSection.username}}" userInput="adminUser" stepKey="fillUsername3"/>
        <fillField selector="{{AdminLoginFormSection.password}}" userInput="adminPassword" stepKey="fillPassword3"/>
        <click selector="{{AdminLoginFormSection.signIn}}" stepKey="clickLogin3"/>
        <see userInput="The account sign-in was incorrect or your account is disabled temporarily. Please wait and try again later." selector="{{AdminLoginFormSection.error}}" stepKey="seeLoginError3"/>

        <!-- Check captcha visibility on admin login page  -->
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaField}}" stepKey="seeCaptchaField1"/>
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaImg}}" stepKey="seeCaptchaImage1"/>
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaReload}}" stepKey="seeCaptchaReloadButton1"/>

        <!-- Submit form with incorrect captcha -->
        <fillField selector="{{AdminLoginFormSection.username}}" userInput="adminUser" stepKey="fillUsername4"/>
        <fillField selector="{{AdminLoginFormSection.password}}" userInput="adminPassword" stepKey="fillPassword4"/>
        <fillField selector="{{AdminLoginFormSection.captchaField}}" userInput="incorrectCaptcha" stepKey="fillCaptcha4"/>
        <click selector="{{AdminLoginFormSection.signIn}}" stepKey="clickLogin4"/>
        <see userInput="Incorrect CAPTCHA." selector="{{AdminLoginFormSection.error}}" stepKey="seeCaptchaError"/>
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaField}}" stepKey="seeCaptchaField2"/>
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaImg}}" stepKey="seeCaptchaImage2"/>
        <waitForElementVisible selector="{{AdminLoginFormSection.captchaReload}}" stepKey="seeCaptchaReloadButton2"/>
    </test>
</tests>
