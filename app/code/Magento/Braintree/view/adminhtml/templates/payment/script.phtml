<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/** @var Magento\Braintree\Block\Payment $block */
/** @var \Magento\Framework\View\Helper\SecureHtmlRenderer $secureRenderer */

$code = $block->escapeHtml($block->getCode());
?>
<?php
$paymentConfig = /* @noEscape */ $block->getPaymentConfig();
$payment_code = /* @noEscape */ $code;
$scriptString = <<<script
    //<![CDATA[
    require(
        [
            'Magento_Braintree/js/braintree',
            'jquery',
            'domReady!'
        ], function(Braintree, $) {
            var config = {$paymentConfig},
                payment,
                form = $('#payment_form_{$payment_code}');

            config.active = form.length > 0 && !form.is(':hidden');
            payment = new Braintree(config);
        });
    //]]>
script;
?>
<?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>
